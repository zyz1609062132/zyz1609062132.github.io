webpackJsonp([7],{COBR:function(t,e){},WvYD:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("BO1k"),c=n.n(a),s=n("mvHQ"),i=n.n(s),o=n("3pLw"),r={data:function(){return{activeName:"1",tableHet:500,umAccount:"",umAccount2:"",username:"",username2:"",channelMgrList:[],cAgencyno:"",cAgencyno2:"",cAgencyname:"",cAgencyname2:"",sellerList:[],cRulevalue:"",cRulevalue2:"",cBranchname:"",cBranchname2:"",branchList:[],cContactno:"",cContactno2:"",cContactname:"",cContactname2:[],contactList:[],contactMeetingA:[],meetingAoption:[],contactMeetingB:[],meetingBoption:[],addressTableData:[],addressloading:!1,visitTableData:[],visitloading:!1,currPage:1,pageSize:50,totalSize:1,currPage2:1,pageSize2:50,totalSize2:1}},components:{filterSelect:n("8BiH").a},mounted:function(){var t=this.getSessionStorage("address-memory-index")?JSON.parse(this.getSessionStorage("address-memory-index")).activeIndex:"";this.activeName=t?t.toString():"1";var e=this.getLocalStorage("address-book-condition");e&&this.setAddressBookData(e)},beforeDestroy:function(){this.setLocalStorage("address-book-condition",i()({channelMrg:{umAccount:"",username:""},channelAgc:{cAgencyno:"",cAgencyname:""},contact:{cContactno:"",cContactname:""}}))},methods:{setAddressBookData:function(t){var e=JSON.parse(t);this.umAccount=e.channelMrg.umAccount,this.username=e.channelMrg.username,this.cAgencyno=e.channelAgc.cAgencyno,this.cAgencyname=e.channelAgc.cAgencyname,this.cContactno=e.contact.cContactno,this.cContactname=e.contact.cContactname,this.getAddressData(),this.umAccount2=e.channelMrg.umAccount,this.username2=e.channelMrg.username,this.cAgencyno2=e.channelAgc.cAgencyno,this.cAgencyname2=e.channelAgc.cAgencyname,this.cContactno2=e.contact.cContactno,this.getVisitData()},checkAddress:function(){this.resetConditon(),this.currPage=1,this.getAddressData()},checkVisit:function(){this.resetConditon(),this.currPage2=1,this.getVisitData()},resetConditon:function(){"1"==this.activeName?(this.umAccount||(this.$refs.channelMgrCon.iptVal=""),this.cAgencyno||(this.$refs.cAgencyCon.iptVal=""),this.cContactno||(this.$refs.cContactCon.iptVal="")):"2"==this.activeName&&(this.umAccount2||(this.$refs.channelMgrCon2.iptVal=""),this.cAgencyno2||(this.$refs.cAgencyCon2.iptVal=""))},getAddressData:function(){var t=this;this.addressloading=!0;var e={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),cChannelmgr:this.umAccount,cAgencyno:this.cAgencyno,cBranchname:this.cBranchname,cContactno:this.cContactno,page:this.currPage,limit:this.pageSize};o.a.post("/crm/nelcontact/selectnelAdrList",e).then(function(e){"0000"===e.code&&(t.totalSize=e.count,t.addressTableData=e.data,t.tableHet=window.innerHeight-320),t.addressloading=!1}).catch(function(e){t.addressloading=!1})},getVisitData:function(){var t=this;this.visitloading=!0;var e={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),cCreater:this.umAccount2,cAgencyno:this.cAgencyno2,cBranchname:this.cBranchname2,visitContact:this.contactMeetingA.join(),visitMgr:this.contactMeetingB.join(),page:this.currPage2,limit:this.pageSize2};o.a.post("/crm/custvisit/selectnelCuVi",e).then(function(e){"0000"===e.code&&(t.totalSize2=e.count,t.visitTableData=e.data,t.tableHet=window.innerHeight-320),t.visitloading=!1}).catch(function(e){t.visitloading=!1})},getChannelMgrList:function(t){var e=this;if(t){var n={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),username:t};o.a.post("/crm/sysuser/search",n).then(function(t){if("0000"===t.code){e.channelMgrList=[];var n=t.data.list,a=!0,s=!1,i=void 0;try{for(var o,r=c()(n);!(a=(o=r.next()).done);a=!0){var l=o.value;e.channelMgrList.push({key:l.umAccount,value:l.username})}}catch(t){s=!0,i=t}finally{try{!a&&r.return&&r.return()}finally{if(s)throw i}}}}).catch(function(t){})}},getSellerList:function(t){var e=this;if(t){var n={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),agencyKey:t};o.a.post("/crm/nelcontact/searchAgency",n).then(function(t){if("0000"===t.code){e.sellerList=[];var n=t.data.list,a=!0,s=!1,i=void 0;try{for(var o,r=c()(n);!(a=(o=r.next()).done);a=!0){var l=o.value;e.sellerList.push({key:l.cAgencyno,value:l.cAgencyname})}}catch(t){s=!0,i=t}finally{try{!a&&r.return&&r.return()}finally{if(s)throw i}}}}).catch(function(t){})}},getLContactist:function(t){var e=this;if(t){var n={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),cContactname:t};o.a.post("/crm/nelcontact/searchnelCon",n).then(function(t){if("0000"===t.code){var n=t.data.list,a=!0,s=!1,i=void 0;try{for(var o,r=c()(n);!(a=(o=r.next()).done);a=!0){var l=o.value;e.contactList.push({key:l.cContactno,value:l.cContactname})}}catch(t){s=!0,i=t}finally{try{!a&&r.return&&r.return()}finally{if(s)throw i}}}}).catch(function(t){})}},getmeetAlist:function(t){var e=this;if(t){var n={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),cContactname:t};o.a.post("/crm/nelcontact/searchnelCon",n).then(function(t){if("0000"===t.code){var n=t.data.list;e.meetingAoption=n}}).catch(function(t){})}},getmeetBlist:function(t){var e=this;if(t){var n={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),username:t};o.a.post("/crm/sysuser/search",n).then(function(t){if("0000"===t.code){var n=t.data.list;e.meetingBoption=n}}).catch(function(t){})}},listenIptValChg:function(t){this.umAccount="",this.getChannelMgrList(t)},listenIptValChg2:function(t){this.cAgencyno="",this.getSellerList(t)},listenIptValChg4:function(t){this.cContactno="",this.contactList=[],this.getLContactist(t)},listenIptValChg12:function(t){this.umAccount2="",this.getChannelMgrList(t)},listenIptValChg22:function(t){this.cAgencyno2="",this.getSellerList(t)},listenIptValChg32:function(t){this.getmeetAlist(t)},listenIptValChg42:function(t){this.getmeetBlist(t)},selectChnage:function(t){this.umAccount=t.key,this.username=t.value},selectChnage2:function(t){this.cAgencyno=t.key,this.cAgencyname=t.value},selectChnage4:function(t){this.cContactno=t.key,this.cContactname=t.value},selectChnage12:function(t){this.umAccount2=t.key,this.username2=t.value},selectChnage22:function(t){this.cAgencyno2=t.key,this.cAgencyname2=t.value},selectChnage32:function(t){},selectChnage42:function(t){},listenUnitChange:function(t){this.currencyUnit=t},handleCurrentChange:function(t){this.currPage=t,this.getAddressData()},handleSizeChange:function(t){this.pageSize=t,this.currPage=1,this.getAddressData()},handleCurrentChange2:function(t){this.currPage2=t,this.getVisitData()},handleSizeChange2:function(t){this.pageSize2=t,this.currPage2=1,this.getVisitData()},createsth:function(t){var e=i()({activeIndex:this.activeName});this.setSessionStorage("address-memory-index",e),this.$router.push({path:"/crm/createcustmg/"+t})},updatesth:function(t,e){var n=t.row;1==e&&this.setLocalStorage("address-book-history",i()(n));var a=i()({activeIndex:this.activeName});this.setSessionStorage("address-memory-index",a),this.$router.push({path:"/crm/createcustmg/"+e,query:{mode:"edit",cVisitid:n.cVisitid}})},routerBack:function(){this.$router.push({path:"/crm/channelCustMage"})}}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"v-channel-con padL10 padR10"},[n("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"通讯录",name:"1"}},[n("div",{staticClass:"marBtm10"},[n("div",{staticClass:"marBtm10 search"},[n("el-form",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"渠道经理"}},[n("filter-select",{ref:"channelMgrCon",staticClass:"wid100pc repairborder",attrs:{initVal:t.username,placeholder:"请输入销售经理名称",round:"",selectOptionData:t.channelMgrList},on:{listenIptValChange:t.listenIptValChg,change:t.selectChnage}})],1)],1),t._v(" "),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"销售商"}},[n("filter-select",{ref:"cAgencyCon",staticClass:"wid100pc repairborder",attrs:{initVal:t.cAgencyname,placeholder:"请输入销售商名称",round:"",selectOptionData:t.sellerList},on:{listenIptValChange:t.listenIptValChg2,change:t.selectChnage2}})],1)],1),t._v(" "),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"分行/分公司"}},[n("el-input",{staticClass:"wid100pc repairborder",attrs:{placeholder:"请输入分行/分公司名称"},model:{value:t.cBranchname,callback:function(e){t.cBranchname=e},expression:"cBranchname"}})],1)],1)],1),t._v(" "),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"客户联系人"}},[n("filter-select",{ref:"cContactCon",staticClass:"wid100pc repairborder",attrs:{initVal:t.cContactname,placeholder:"请输入联系人名称",round:"",selectOptionData:t.contactList},on:{listenIptValChange:t.listenIptValChg4,change:t.selectChnage4}})],1)],1),t._v(" "),n("el-col",{attrs:{span:8}},[n("div",{staticClass:"grid-content"})]),t._v(" "),n("el-col",{attrs:{span:8}},[n("div",{staticClass:"wedge"}),t._v(" "),n("div",{},[n("el-button",{on:{click:t.checkAddress}},[t._v("查询")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.createsth(1)}}},[t._v("新增通讯录")])],1)])],1)],1)],1),t._v(" "),n("div",{staticClass:"hidden"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.addressloading,expression:"addressloading"}],staticStyle:{width:"100%"},attrs:{stripe:"",data:t.addressTableData,"max-height":t.tableHet,border:"","tooltip-effect":"dark"}},[n("el-table-column",{attrs:{fixed:"",type:"index",label:"序号",width:"50",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{fixed:"",prop:"cAgencyname",label:"销售商",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,1)}}},[t._v(t._s(e.row.cAgencyname))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"cBranchname",label:"分行/分公司",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,1)}}},[t._v(t._s(e.row.cBranchname))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"cBankBranch",label:"支行/营业部",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,1)}}},[t._v(t._s(e.row.cBankBranch?e.row.cBankBranch:"--"))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"cContactname",label:"客户联系人",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,1)}}},[t._v(t._s(e.row.cContactname))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"cContactdpt",label:"部门",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,1)}}},[t._v(t._s(e.row.cContactdpt))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"cContactposition",label:"职位",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,1)}}},[t._v(t._s(e.row.cContactposition))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"username",label:"渠道经理",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,1)}}},[t._v(t._s(e.row.username))])]}}])})],1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.addressTableData.length>0,expression:"addressTableData.length > 0"}],staticClass:"pag-con"},[n("el-pagination",{attrs:{"page-sizes":[15,30,50],"page-size":t.pageSize,"current-page":t.currPage,layout:"prev, pager, next, sizes",background:"",total:t.totalSize},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]),t._v(" "),n("el-tab-pane",{attrs:{label:"拜访记录",name:"2"}},[n("div",{staticClass:"marBtm10"},[n("div",{staticClass:"marBtm10 search"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("el-form",[n("el-form-item",{attrs:{label:"渠道经理"}},[n("filter-select",{ref:"channelMgrCon2",staticClass:"wid100pc repairborder",attrs:{initVal:t.username2,placeholder:"请输入销售经理名称",round:"",selectOptionData:t.channelMgrList},on:{listenIptValChange:t.listenIptValChg12,change:t.selectChnage12}})],1)],1)],1),t._v(" "),n("el-col",{attrs:{span:8}},[n("el-form",[n("el-form-item",{attrs:{label:"销售商"}},[n("filter-select",{ref:"cAgencyCon2",staticClass:"wid100pc repairborder",attrs:{initVal:t.cAgencyname2,placeholder:"请输入销售商名称",round:"",selectOptionData:t.sellerList},on:{listenIptValChange:t.listenIptValChg22,change:t.selectChnage22}})],1)],1)],1),t._v(" "),n("el-col",{attrs:{span:8}},[n("el-form",[n("el-form-item",{attrs:{label:"分行/分公司"}},[n("el-input",{staticClass:"wid100pc repairborder",attrs:{placeholder:"请输入分行/分公司名称"},model:{value:t.cBranchname2,callback:function(e){t.cBranchname2=e},expression:"cBranchname2"}})],1)],1)],1)],1),t._v(" "),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("el-form",[n("el-form-item",{attrs:{label:"甲方参会人员"}},[n("el-select",{staticClass:"wid100pc channelana-ipt",attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入搜索甲方参会人员","remote-method":t.listenIptValChg32},on:{change:t.selectChnage32},model:{value:t.contactMeetingA,callback:function(e){t.contactMeetingA=e},expression:"contactMeetingA"}},t._l(t.meetingAoption,function(t){return n("el-option",{key:t.cContactno,attrs:{label:t.cContactname,value:t.cContactno}})}))],1)],1)],1),t._v(" "),n("el-col",{attrs:{span:8}},[n("el-form",[n("el-form-item",{attrs:{label:"我司陪同人员"}},[n("el-select",{staticClass:"wid100pc channelana-ipt",attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入搜索我司陪同人员","remote-method":t.listenIptValChg42},on:{change:t.selectChnage42},model:{value:t.contactMeetingB,callback:function(e){t.contactMeetingB=e},expression:"contactMeetingB"}},t._l(t.meetingBoption,function(t){return n("el-option",{key:t.umAccount,attrs:{label:t.username,value:t.umAccount}})}))],1)],1)],1),t._v(" "),n("el-col",{attrs:{span:8}},[n("div",{staticClass:"wedge"}),t._v(" "),n("div",{},[n("el-button",{on:{click:t.checkVisit}},[t._v("查询")]),t._v(" "),n("el-button",{staticClass:"padLR25",attrs:{type:"primary"},on:{click:function(e){t.createsth(2)}}},[t._v("新增拜访记录")])],1)])],1)],1),t._v(" "),n("div",{staticClass:"hidden"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.visitloading,expression:"visitloading"}],staticStyle:{width:"100%"},attrs:{stripe:"",data:t.visitTableData,"max-height":t.tableHet,"tooltip-effect":"dark"}},[n("el-table-column",{attrs:{type:"index",label:"序号",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{property:"cContactname",label:"甲方参会人员",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,2)}}},[t._v(t._s(e.row.cContactname))])]}}])}),t._v(" "),n("el-table-column",{attrs:{property:"cAgencyname",label:"销售商",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,2)}}},[t._v(t._s(e.row.cAgencyname))])]}}])}),t._v(" "),n("el-table-column",{attrs:{property:"cBranchname",label:"分行/分公司",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,2)}}},[t._v(t._s(e.row.cBranchname))])]}}])}),t._v(" "),n("el-table-column",{attrs:{property:"cBankBranch",label:"支行/营业部",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,2)}}},[t._v(t._s(e.row.cBankBranch?e.row.cBankBranch:"--"))])]}}])}),t._v(" "),n("el-table-column",{attrs:{property:"cCreater",label:"渠道经理",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,2)}}},[t._v(t._s(e.row.cCreater))])]}}])}),t._v(" "),n("el-table-column",{attrs:{property:"username",label:"我司陪同人员",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,2)}}},[t._v(t._s(e.row.username))])]}}])}),t._v(" "),n("el-table-column",{attrs:{property:"dVisitdate",label:"拜访日期",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{on:{click:function(n){t.updatesth(e,2)}}},[t._v(t._s(e.row.dVisitdate))])]}}])}),t._v(" "),n("el-table-column",{attrs:{property:"cContent",label:"拜访记录","show-overflow-tooltip":"",align:"center"}})],1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.visitTableData.length>0,expression:"visitTableData.length > 0"}],staticClass:"pag-con"},[n("el-pagination",{attrs:{"page-sizes":[15,30,50],"page-size":t.pageSize2,"current-page":t.currPage2,layout:"prev, pager, next, sizes",background:"",total:t.totalSize2},on:{"size-change":t.handleSizeChange2,"current-change":t.handleCurrentChange2}})],1)])])],1)],1)},staticRenderFns:[]};var u=n("VU/8")(r,l,!1,function(t){n("COBR")},"data-v-f6e8e962",null);e.default=u.exports}});