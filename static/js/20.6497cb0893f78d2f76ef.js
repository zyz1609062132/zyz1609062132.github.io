webpackJsonp([20],{L06M:function(t,e){},dH9w:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("BO1k"),s=a.n(r),i=a("3pLw"),o={data:function(){return{addType:this.$route.query.addType,cCustname:this.$route.query.cCustname,cCustno:this.$route.query.cCustno,autosize:{minRows:6,maxRows:10},remarkform:{username:this.getSessionStorage("usernameOfThisPeople"),custName:this.$route.query.custName,dRecordtimeStr:"",cRemarkcontent:""},visitRecordForm:{cContactmgr:this.getSessionStorage("usernameOfThisPeople"),cCustname:this.$route.query.cCustname,cCustno:this.$route.query.cCustno,cVisittime:"",cSummary:"",cContactno:"",cContent:""},contactPersonList:[],tempdRecordtimeStr:"",isDisabled:!1}},components:{filterSelect:a("8BiH").a},mounted:function(){this.modifyRecordTime()},methods:{selectChnage3:function(t){this.visitRecordForm.cContactno=t.value,this.tcContactno2=t.key,""==t.key&&this.$router.push({path:"createAbavr",query:{type:"01"}})},listenIptValChg3:function(t){this.visitRecordForm.cContactno=t,this.checkContactPerson(t)},modifyRecordTime:function(){var t=new Date,e=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+"  "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();this.changeRemarktime(e),this.remarkform.dRecordtimeStr=e},checkContactPerson:function(t){var e=this,a={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),cContactname:t};i.a.post("/crm/custinfo/searchCon",a).then(function(t){if("0000"===t.code){if(t.data.list){e.contactPersonList=[];var a=t.data.list,r=!0,i=!1,o=void 0;try{for(var c,n=s()(a);!(r=(c=n.next()).done);r=!0){var m=c.value;e.contactPersonList.push({key:m.cContactno,value:m.cContactname})}}catch(t){i=!0,o=t}finally{try{!r&&n.return&&n.return()}finally{if(i)throw o}}}e.contactPersonList.push({key:"",value:"新建联系人"})}}).catch(function(t){})},querySearch3:function(t,e){var a=this.cContactnameList;e(t?a.filter(this.createFilter3(t)):a)},createFilter3:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelect5:function(t){this.tcContactno2=t.label},routerBack:function(){"1"==this.addType?localStorage.setItem("activeName","08"):"2"==this.addType&&localStorage.setItem("activeName","09"),this.$router.go("-1")},onSubmit:function(t){var e=this;if("1"==t)if(this.visitRecordForm.cSummary&&this.visitRecordForm.cContent){this.isDisabled=!0;var a={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),cCustmgr:this.getLocalStorage("username"),cCustno:this.cCustno,cContactno:this.tcContactno2,cVisittime:this.visitRecordForm.cVisittime,cSummary:this.visitRecordForm.cSummary,cContent:this.visitRecordForm.cContent};i.a.post("/crm/custvisit/addCuVi",a).then(function(t){"0000"===t.code&&(e.$message({message:"新增成功",type:"info"}),e.routerBack()),e.isDisabled=!1}).catch(function(t){e.$message({message:"新增失败",type:"error"}),e.isDisabled=!1})}else this.$message({message:"标记红色星号为必填项",type:"warning"});else if("2"==t)if(this.remarkform.cRemarkcontent){this.isDisabled=!0;var r={token:this.getLocalStorage("token"),h5loginusername:this.getLocalStorage("username"),cRemarkcontent:this.remarkform.cRemarkcontent,dRecordtimeStr:this.remarkform.dRecordtimeStr,cCustno:this.cCustno};i.a.post("/crm/custinfo/custRemarkSave",r).then(function(t){"0000"===t.code?(e.$message({message:"新增成功",type:"info"}),e.routerBack()):e.$message({message:"新增失败,"+t.msg,type:"info"}),e.isDisabled=!1}).catch(function(t){e.$message({message:"新增失败",type:"error"}),e.isDisabled=!1})}else this.$message({message:"标记红色星号为必填项",type:"warning"})},changeCVisittime:function(t){this.visitRecordForm.cVisittime=this.standardTime(t)},changeRemarktime:function(t){var e=new Date(t).toJSON();this.tempdRecordtimeStr=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,""),this.remarkform.dRecordtimeStr=t}}},c={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"visitRecordAndRemarkAdd-wrap pad10"},[r("div",{staticClass:"visitRecordAndRemarkAdd-main"},[r("span",{staticClass:"visitRecordAndRemarkAdd-main-back",on:{click:t.routerBack}},[r("img",{staticClass:"back-icon",attrs:{src:a("0YUB"),alt:""}}),t._v(" "),r("i",{staticStyle:{"padding-left":"5px",color:"#cf9f68"}},[t._v("返回")])]),t._v(" "),r("span",{staticClass:"visitRecordAndRemarkAdd-main-title"},[t._v(t._s("1"==this.addType?"新增拜访记录":"新增备注说明"))])]),t._v(" "),r("div",{staticClass:"visitRecordAndRemarkAdd-main-header pad10"},["1"==this.addType?r("div",{staticClass:"visitRecordAndRemarkAdd-main-body"},[r("el-form",{ref:"form",attrs:{model:t.visitRecordForm}},[r("el-row",{attrs:{gutter:24}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"销售经理",required:""}},[r("el-input",{staticClass:"modify-input",attrs:{disabled:!0},model:{value:t.visitRecordForm.cContactmgr,callback:function(e){t.$set(t.visitRecordForm,"cContactmgr",e)},expression:"visitRecordForm.cContactmgr"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"机构名称"}},[r("el-input",{staticClass:"modify-input",attrs:{disabled:!0},model:{value:t.visitRecordForm.cCustname,callback:function(e){t.$set(t.visitRecordForm,"cCustname",e)},expression:"visitRecordForm.cCustname"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"联系人"}},[r("filter-select",{staticClass:"wid100pc",attrs:{initVal:t.visitRecordForm.cContactno,around:"",placeholder:"请输入联系人关键词搜索",selectOptionData:t.contactPersonList},on:{listenIptValChange:t.listenIptValChg3,change:t.selectChnage3}})],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:24}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"拜访日期"}},[r("el-date-picker",{staticClass:"modify-input",attrs:{editable:!1,type:"date",placeholder:"选择日期"},on:{change:t.changeCVisittime},model:{value:t.visitRecordForm.cVisittime,callback:function(e){t.$set(t.visitRecordForm,"cVisittime",e)},expression:"visitRecordForm.cVisittime"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"拜访摘要",required:""}},[r("el-input",{staticClass:"modify-input",attrs:{maxlength:"16"},model:{value:t.visitRecordForm.cSummary,callback:function(e){t.$set(t.visitRecordForm,"cSummary",e)},expression:"visitRecordForm.cSummary"}})],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:24}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"拜访记录",required:""}},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.visitRecordForm.cContent,expression:"visitRecordForm.cContent"}],staticClass:"modify-input tempTextarea",staticStyle:{"-webkit-user-select":"auto"},attrs:{type:"text",maxlength:"2000"},domProps:{value:t.visitRecordForm.cContent},on:{input:function(e){e.target.composing||t.$set(t.visitRecordForm,"cContent",e.target.value)}}})])],1)],1),t._v(" "),r("div",{staticClass:"btn-box"},[r("el-button",{on:{click:t.routerBack}},[t._v("取消")]),t._v(" "),r("el-button",{attrs:{type:"primary",disabled:t.isDisabled},on:{click:function(e){t.onSubmit(1)}}},[t._v("确定")])],1)],1)],1):t._e(),t._v(" "),"2"==this.addType?r("div",{staticClass:"visitRecordAndRemarkAdd-main-body"},[r("el-form",{ref:"form",attrs:{model:t.remarkform}},[r("el-row",{attrs:{gutter:24}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"记录人"}},[r("el-input",{staticClass:"modify-input",attrs:{disabled:!0},model:{value:t.remarkform.username,callback:function(e){t.$set(t.remarkform,"username",e)},expression:"remarkform.username"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"记录日期"}},[r("el-date-picker",{staticClass:"modify-input",attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",editable:!1,"default-value":t.remarkform.dRecordtimeStr,format:"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期"},on:{change:t.changeRemarktime},model:{value:t.remarkform.dRecordtimeStr,callback:function(e){t.$set(t.remarkform,"dRecordtimeStr",e)},expression:"remarkform.dRecordtimeStr"}})],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:24}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"记录内容",required:""}},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.remarkform.cRemarkcontent,expression:"remarkform.cRemarkcontent"}],staticClass:"modify-input tempTextarea",staticStyle:{"-webkit-user-select":"auto"},attrs:{type:"text",maxlength:"160"},domProps:{value:t.remarkform.cRemarkcontent},on:{input:function(e){e.target.composing||t.$set(t.remarkform,"cRemarkcontent",e.target.value)}}})])],1)],1),t._v(" "),r("div",{staticClass:"btn-box"},[r("el-button",{on:{click:t.routerBack}},[t._v("取消")]),t._v(" "),r("el-button",{attrs:{type:"primary",disabled:t.isDisabled},on:{click:function(e){t.onSubmit(2)}}},[t._v("确定")])],1)],1)],1):t._e()])])},staticRenderFns:[]};var n=a("VU/8")(o,c,!1,function(t){a("L06M")},"data-v-60821c22",null);e.default=n.exports}});